<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块 | 个人博客</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.d9af7a00.css" as="style"><link rel="preload" href="/assets/js/app.6ba358d5.js" as="script"><link rel="preload" href="/assets/js/2.ae98e73b.js" as="script"><link rel="preload" href="/assets/js/29.39ddf55c.js" as="script"><link rel="prefetch" href="/assets/js/10.42ff595e.js"><link rel="prefetch" href="/assets/js/11.4ed22736.js"><link rel="prefetch" href="/assets/js/12.6a6a3966.js"><link rel="prefetch" href="/assets/js/13.2dc17c00.js"><link rel="prefetch" href="/assets/js/14.ecd84e84.js"><link rel="prefetch" href="/assets/js/15.8e63941b.js"><link rel="prefetch" href="/assets/js/16.20bbf036.js"><link rel="prefetch" href="/assets/js/17.cee65893.js"><link rel="prefetch" href="/assets/js/18.210997b6.js"><link rel="prefetch" href="/assets/js/19.6a9e1c28.js"><link rel="prefetch" href="/assets/js/20.58544cb3.js"><link rel="prefetch" href="/assets/js/21.13c2449f.js"><link rel="prefetch" href="/assets/js/22.b999c181.js"><link rel="prefetch" href="/assets/js/23.ba0e1341.js"><link rel="prefetch" href="/assets/js/24.4d053282.js"><link rel="prefetch" href="/assets/js/25.afea9c0f.js"><link rel="prefetch" href="/assets/js/26.eebee834.js"><link rel="prefetch" href="/assets/js/27.b5e919f8.js"><link rel="prefetch" href="/assets/js/28.eb2b8d47.js"><link rel="prefetch" href="/assets/js/3.01798808.js"><link rel="prefetch" href="/assets/js/30.6d0c38c0.js"><link rel="prefetch" href="/assets/js/31.ae50bd7b.js"><link rel="prefetch" href="/assets/js/32.8f993527.js"><link rel="prefetch" href="/assets/js/33.e7076b44.js"><link rel="prefetch" href="/assets/js/34.02650f79.js"><link rel="prefetch" href="/assets/js/35.78660043.js"><link rel="prefetch" href="/assets/js/36.5720a95b.js"><link rel="prefetch" href="/assets/js/37.61ee918b.js"><link rel="prefetch" href="/assets/js/38.dfa679d1.js"><link rel="prefetch" href="/assets/js/39.ed80ae84.js"><link rel="prefetch" href="/assets/js/4.086bf268.js"><link rel="prefetch" href="/assets/js/40.984dfb70.js"><link rel="prefetch" href="/assets/js/41.39b0efef.js"><link rel="prefetch" href="/assets/js/42.348c0630.js"><link rel="prefetch" href="/assets/js/43.af859649.js"><link rel="prefetch" href="/assets/js/44.231224a1.js"><link rel="prefetch" href="/assets/js/45.58ade8a2.js"><link rel="prefetch" href="/assets/js/46.87a325ea.js"><link rel="prefetch" href="/assets/js/47.639c4fd3.js"><link rel="prefetch" href="/assets/js/48.17b33593.js"><link rel="prefetch" href="/assets/js/49.f5dc4f70.js"><link rel="prefetch" href="/assets/js/5.33e71d3e.js"><link rel="prefetch" href="/assets/js/50.e91de543.js"><link rel="prefetch" href="/assets/js/51.8e808c23.js"><link rel="prefetch" href="/assets/js/52.210b18bf.js"><link rel="prefetch" href="/assets/js/53.51bb9c18.js"><link rel="prefetch" href="/assets/js/54.cc3b4480.js"><link rel="prefetch" href="/assets/js/55.d360f572.js"><link rel="prefetch" href="/assets/js/56.2a89706d.js"><link rel="prefetch" href="/assets/js/6.45b5ea40.js"><link rel="prefetch" href="/assets/js/7.227a1975.js"><link rel="prefetch" href="/assets/js/8.9cffc684.js"><link rel="prefetch" href="/assets/js/9.62b6f021.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d9af7a00.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">vue</a></div><div class="nav-item"><a href="/" class="nav-link">css</a></div><div class="nav-item"><a href="/" class="nav-link">js</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fengjinlong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fengjinlong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">vue</a></div><div class="nav-item"><a href="/" class="nav-link">css</a></div><div class="nav-item"><a href="/" class="nav-link">js</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">github</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/fengjinlong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/fengjinlong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  2
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/defineProperty.html" class="sidebar-link">Object属性系列</a></li><li><a href="/js/Decorator.html" class="sidebar-link">Decorators</a></li><li><a href="/js/Decorator2.html" class="sidebar-link">Decorator 应用</a></li><li><a href="/js/eventBus.html" class="sidebar-link">eventBus</a></li><li><a href="/js/模块.html" class="active sidebar-link">模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/模块.html#严格模式" class="sidebar-link">严格模式</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#模块功能" class="sidebar-link">模块功能</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#export" class="sidebar-link">export</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#import-命令" class="sidebar-link">import 命令</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#模块的整体加载" class="sidebar-link">模块的整体加载</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#export-default-命令" class="sidebar-link">export default 命令</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#import" class="sidebar-link">import()</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#import-适用场合" class="sidebar-link">import()适用场合</a></li><li class="sidebar-sub-header"><a href="/js/模块.html#注意点" class="sidebar-link">注意点</a></li></ul></li><li><a href="/js/bind&amp;new.html" class="sidebar-link">bind</a></li><li><a href="/js/es5.html" class="sidebar-link">ES5</a></li><li><a href="/js/es6.html" class="sidebar-link">ES6</a></li><li><a href="/js/语言精髓.html" class="sidebar-link">原型</a></li><li><a href="/js/promise.html" class="sidebar-link">Promise基础</a></li><li><a href="/js/promise思路.html" class="sidebar-link">手写思路</a></li><li><a href="/js/深拷贝.html" class="sidebar-link">深拷贝</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>yarn</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>php</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>gulp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mac</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>functional</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写代码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JSON</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>博文</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="模块"><a href="#模块" aria-hidden="true" class="header-anchor">#</a> 模块</h1> <h2 id="严格模式"><a href="#严格模式" aria-hidden="true" class="header-anchor">#</a> 严格模式</h2> <blockquote><p>变量必须声明后再使用</p></blockquote> <blockquote><p>函数的参数不能有同名属性，否则报错</p></blockquote> <blockquote><p>不能使用with语句</p></blockquote> <blockquote><p>不能对只读属性赋值，否则报错</p></blockquote> <blockquote><p>不能使用前缀 0 表示八进制数，否则报错</p></blockquote> <blockquote><p>不能删除不可删除的属性，否则报错</p></blockquote> <blockquote><p>不能删除变量delete prop，会报错，只能删除属性delete global[prop]</p></blockquote> <blockquote><p>eval不会在它的外层作用域引入变量</p></blockquote> <blockquote><p>eval和arguments不能被重新赋值</p></blockquote> <blockquote><p>arguments不会自动反映函数参数的变化</p></blockquote> <blockquote><p>不能使用arguments.callee</p></blockquote> <blockquote><p>不能使用arguments.caller</p></blockquote> <blockquote><p>禁止this指向全局对象</p></blockquote> <blockquote><p>不能使用fn.caller和fn.arguments获取函数调用的堆栈</p></blockquote> <blockquote><p>增加了保留字（比如protected、static和interface）</p></blockquote> <h2 id="模块功能"><a href="#模块功能" aria-hidden="true" class="header-anchor">#</a> 模块功能</h2> <blockquote><p>主要由两个命令构成：export和import。export命令用于规定模块的对外接口，import命令用于输入其他模块提供的功能。</p></blockquote> <h2 id="export"><a href="#export" aria-hidden="true" class="header-anchor">#</a> export</h2> <div class="language- extra-class"><pre class="language-text"><code>// profile.js
export var firstName = 'Michael';
export var lastName = 'Jackson';
export var year = 1958;

export的写法，除了像上面这样，还有另外一种。
var firstName = 'Michael';
var lastName = 'Jackson';
var year = 1958;
export { firstName, lastName, year };

export function multiply(x, y) {
  return x * y;
};

通常情况下，export输出的变量就是本来的名字，但是可以使用as关键字重命名。
function v1() { ... }
function v2() { ... }
export {
  v1 as streamV1,
  v2 as streamV2,
  v2 as streamLatestVersion
};
</code></pre></div><blockquote><p>export命令规定的是对外的接口，必须与模块内部的变量建立一一对应关系。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 报错
export 1;

// 报错
var m = 1;
export m;
</code></pre></div><blockquote><p>第一种写法直接输出 1，第二种写法通过变量m，还是直接输出 1。1只是一个值，不是接口。正确的写法是下面这样。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 写法一
export var m = 1;

// 写法二
var m = 1;
export {m};

// 写法三
var n = 1;
export {n as m};
</code></pre></div><blockquote><p>function和class的输出，也必须遵守这样的写法。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 报错
function f() {}
export f;

// 正确
export function f() {};

// 正确
function f() {}
export {f};
</code></pre></div><blockquote><p>export语句输出的接口，与其对应的值是动态绑定关系，即通过该接口，可以取到模块内部实时的值。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>export var foo = 'bar';
setTimeout(() =&gt; foo = 'baz', 500);
上面代码输出变量foo，值为bar，500 毫秒之后变成baz。

这一点与 CommonJS 规范完全不同。CommonJS 模块输出的是值的缓存，不存在动态更新
</code></pre></div><h2 id="import-命令"><a href="#import-命令" aria-hidden="true" class="header-anchor">#</a> import 命令</h2> <blockquote><p>大括号里面的变量名，必须与被导入模块（profile.js）对外接口的名称相同。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// main.js
import { firstName, lastName, year } from './profile.js';
</code></pre></div><blockquote><p>如果想为输入的变量重新取一个名字，import命令要使用as关键字，将输入的变量重命名。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import { lastName as surname } from './profile.js';
</code></pre></div><blockquote><p>import命令具有提升效果，会提升到整个模块的头部，首先执行。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>foo();

import { foo } from 'my_module';
</code></pre></div><blockquote><p>import语句会执行所加载的模块，因此可以有下面的写法。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import 'lodash';
上面代码仅仅执行lodash模块，但是不输入任何值。

如果多次重复执行同一句import语句，那么只会执行一次，而不会执行多次。

import 'lodash';
import 'lodash';
上面代码加载了两次lodash，但是只会执行一次。

import { foo } from 'my_module';
import { bar } from 'my_module';

// 等同于
import { foo, bar } from 'my_module';
上面代码中，虽然foo和bar在两个语句中加载，但是它们对应的是同一个my_module实例。也就是说，import语句是 Singleton 模式。
</code></pre></div><h2 id="模块的整体加载"><a href="#模块的整体加载" aria-hidden="true" class="header-anchor">#</a> 模块的整体加载</h2> <blockquote><p>除了指定加载某个输出值，还可以使用整体加载，即用星号（*）指定一个对象，所有输出值都加载在这个对象上面。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// circle.js

export function area(radius) {
  return Math.PI * radius * radius;
}

export function circumference(radius) {
  return 2 * Math.PI * radius;
}
现在，加载这个模块。

// main.js

import * as circle from './circle';

console.log('圆面积：' + circle.area(4));
console.log('圆周长：' + circle.circumference(14));
注意，模块整体加载所在的那个对象（上例是circle），应该是可以静态分析的，所以不允许运行时改变。下面的写法都是不允许的。

import * as circle from './circle';

// 下面两行都是不允许的
circle.foo = 'hello';
circle.area = function () {};
</code></pre></div><h2 id="export-default-命令"><a href="#export-default-命令" aria-hidden="true" class="header-anchor">#</a> export default 命令</h2> <div class="language- extra-class"><pre class="language-text"><code>// export-default.js
export default function () {
  console.log('foo');
}
</code></pre></div><blockquote><p>上面代码是一个模块文件export-default.js，它的默认输出是一个函数。</p></blockquote> <blockquote><p>其他模块加载该模块时，import命令可以为该匿名函数指定任意名字。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// import-default.js
import customName from './export-default';
customName(); /
</code></pre></div><blockquote><p>上面代码的import命令，可以用任意名称指向export-default.js输出的方法，这时就不需要知道原模块输出的函数名。需要注意的是，这时import命令后面，不使用大括号。</p></blockquote> <blockquote><p>export default命令用在非匿名函数前，也是可以的。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// export-default.js
export default function foo() {
  console.log('foo');
}

// 或者写成

function foo() {
  console.log('foo');
}

export default foo;
</code></pre></div><blockquote><p>上面代码中，foo函数的函数名foo，在模块外部是无效的。加载的时候，视同匿名函数加载。</p></blockquote> <blockquote><p>对比</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 第一组
export default function crc32() { // 输出
  // ...
}

import crc32 from 'crc32'; // 输入

// 第二组
export function crc32() { // 输出
  // ...
};

import {crc32} from 'crc32'; // 输入
</code></pre></div><blockquote><p>上面代码的两组写法，第一组是使用export default时，对应的import语句不需要使用大括号；第二组是不使用export default时，对应的import语句需要使用大括号。</p></blockquote> <blockquote><p>export default命令用于指定模块的默认输出。显然，一个模块只能有一个默认输出，因此export default命令只能使用一次。所以，import命令后面才不用加大括号，因为只可能唯一对应export default命令。</p></blockquote> <blockquote><p>本质上，export default就是输出一个叫做default的变量或方法，然后系统允许你为它取任意名字。所以，下面的写法是有效的。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// modules.js
function add(x, y) {
  return x * y;
}
export {add as default};
// 等同于
// export default add;

// app.js
import { default as foo } from 'modules';
// 等同于
// import foo from 'modules';
</code></pre></div><blockquote><p>正是因为export default命令其实只是输出一个叫做default的变量，所以它后面不能跟变量声明语句。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 正确
export var a = 1;

// 正确
var a = 1;
export default a;

// 错误
export default var a = 1;
</code></pre></div><blockquote><p>上面代码中，export default a的含义是将变量a的值赋给变量default。所以，最后一种写法会报错。</p></blockquote> <blockquote><p>同样地，因为export default命令的本质是将后面的值，赋给default变量，所以可以直接将一个值写在export default之后。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 正确
export default 42;

// 报错
export 42;
</code></pre></div><blockquote><p>有了export default命令，输入模块时就非常直观了，以输入 lodash 模块为例。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import _ from 'lodash';
</code></pre></div><blockquote><p>如果想在一条import语句中，同时输入默认方法和其他接口，可以写成下面这样。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import _, { each, forEach } from 'lodash';
</code></pre></div><blockquote><p>对应上面代码的export语句如下。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>export default function (obj) {
  // ···
}

export function each(obj, iterator, context) {
  // ···
}

export { each as forEach };
</code></pre></div><blockquote><p>export default也可以用来输出类。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// MyClass.js
export default class { ... }

// main.js
import MyClass from 'MyClass';
let o = new MyClass();
</code></pre></div><h2 id="import"><a href="#import" aria-hidden="true" class="header-anchor">#</a> import()</h2> <blockquote><p>前面介绍过，import命令会被 JavaScript 引擎静态分析，先于模块内的其他语句执行（import命令叫做“连接” binding 其实更合适）。所以，下面的代码会报错。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>// 报错
if (x === 2) {
  import MyModual from './myModual';
}
</code></pre></div><blockquote><p>上面代码中，引擎处理import语句是在<strong>编译时</strong>，这时不会去分析或执行if语句，所以import语句放在if代码块之中毫无意义，因此会报句法错误，而不是执行时错误。也就是说，<strong>import和export命令只能在模块的顶层，不能在代码块之中（比如，在if代码块之中，或在函数之中）。</strong></p></blockquote> <blockquote><p>这样的设计，固然有利于编译器提高效率，但也导致无法在运行时加载模块。在语法上，条件加载就不可能实现。如果import命令要取代 Node 的require方法，这就形成了一个障碍。
因为require是运行时加载模块，import命令无法取代<strong>require的动态加载</strong>功能。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>const path = './' + fileName;
const myModual = require(path);
</code></pre></div><blockquote><p>上面的语句就是<strong>动态加载</strong>，require到底加载哪一个模块，只有运行时才知道。import命令做不到这一点。</p></blockquote> <blockquote><p>因此，有一个提案，建议引入import()函数，完成动态加载。</p></blockquote> <blockquote><p>import()返回一个 Promise 对象。下面是一个例子。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>const main = document.querySelector('main');

import(`./section-modules/${someVariable}.js`)
  .then(module =&gt; {
    module.loadPageInto(main);
  })
  .catch(err =&gt; {
    main.textContent = err.message;
  });
</code></pre></div><blockquote><p>import()类似于 Node 的require方法，区别主要是<strong>前者是异步加载，后者是同步加载</strong>。</p></blockquote> <h2 id="import-适用场合"><a href="#import-适用场合" aria-hidden="true" class="header-anchor">#</a> import()适用场合</h2> <blockquote><p>+按需加载。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import()可以在需要的时候，再加载某个模块。
button.addEventListener('click', event =&gt; {
  import('./dialogBox.js')
  .then(dialogBox =&gt; {
    dialogBox.open();
  })
  .catch(error =&gt; {
    /* Error handling */
  })
});
上面代码中，import()方法放在click事件的监听函数之中，只有用户点击了按钮，才会加载这个模块。
</code></pre></div><blockquote><p>+条件加载</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import()可以放在if代码块，根据不同的情况，加载不同的模块。

if (condition) {
  import('moduleA').then(...);
} else {
  import('moduleB').then(...);
}
上面代码中，如果满足条件，就加载模块 A，否则加载模块 B。
</code></pre></div><blockquote><p>+动态的模块路径</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import()允许模块路径动态生成。

import(f())
.then(...);
上面代码中，根据函数f的返回结果，加载不同的模块。
</code></pre></div><h2 id="注意点"><a href="#注意点" aria-hidden="true" class="header-anchor">#</a> 注意点</h2> <blockquote><p>import()加载模块成功以后，这个模块会作为一个对象，当作then方法的参数。因此，可以使用对象解构赋值的语法，获取输出接口。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import('./myModule.js')
.then(({export1, export2}) =&gt; {
  // ...·
});
上面代码中，export1和export2都是myModule.js的输出接口，可以解构获得。
</code></pre></div><blockquote><p>如果模块有default输出接口，可以用参数直接获得。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>import('./myModule.js')
.then(myModule =&gt; {
  console.log(myModule.default);
});
上面的代码也可以使用具名输入的形式。

import('./myModule.js')
.then(({default: theDefault}) =&gt; {
  console.log(theDefault);
});
</code></pre></div><blockquote><p>如果想同时加载多个模块，可以采用下面的写法。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>Promise.all([
  import('./module1.js'),
  import('./module2.js'),
  import('./module3.js'),
])
.then(([module1, module2, module3]) =&gt; {
   ···
});
</code></pre></div><blockquote><p>import()也可以用在 async 函数之中。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>async function main() {
  const myModule = await import('./myModule.js');
  const {export1, export2} = await import('./myModule.js');
  const [module1, module2, module3] =
    await Promise.all([
      import('./module1.js'),
      import('./module2.js'),
      import('./module3.js'),
    ]);
}
main();
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">有志者，事竞成；苦心人，天不负: </span> <span class="time">10/23/2019, 4:08:36 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/js/eventBus.html" class="prev">
          eventBus
        </a></span> <span class="next"><a href="/js/bind&amp;new.html">
          bind
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6ba358d5.js" defer></script><script src="/assets/js/2.ae98e73b.js" defer></script><script src="/assets/js/29.39ddf55c.js" defer></script>
  </body>
</html>
