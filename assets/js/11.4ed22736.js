(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{197:function(e,n,t){"use strict";t.r(n);var a=t(0),s=Object(a.a)({},function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker","aria-hidden":"true"}},[e._v("#")]),e._v(" docker")]),e._v(" "),t("h3",{attrs:{id:"demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#demo","aria-hidden":"true"}},[e._v("#")]),e._v(" demo")]),e._v(" "),t("ol",[t("li",[e._v("⾸先创建⼀个空⽂件夹。并创建以下⽂件")])]),e._v(" "),t("blockquote",[t("ul",[t("li",[e._v("server.js")])]),e._v(" "),t("ul",[t("li",[e._v("package.json")])]),e._v(" "),t("ul",[t("li",[e._v("Dockerfile")])]),e._v(" "),t("ul",[t("li",[e._v(".dockerignore")])])]),e._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[e._v("server.js")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("const Koa = require('koa');\nconst app = new Koa();\napp.use(async ctx => {\nctx.body = 'Hello docker';\n});\napp.listen(3000);\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[e._v("package.json")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('{\n"name": "docker_demo",\n"version": "0.1.0",\n"private": true,\n"scripts": {\n"start": "node server.js"\n },\n"dependencies": {\n"koa": "^2.5.0"\n }\n}\n')])])]),t("ol",{attrs:{start:"4"}},[t("li",[e._v(".dockerignore")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# Logs\nlogs\n*.log\nnpm-debug.log*\n# Runtime data\npids\n*.pid\n*.seed\n# Directory for instrumented libs generated by jscoverage/JSCover\nlib-cov\n# Coverage directory used by tools like istanbul\ncoverage\n# nyc test coverage\n.nyc_output\n# Grunt intermediate storage (http://gruntjs.com/creatingplugins#storing-task-files)\n.grunt\n# node-waf configuration\n.lock-wscript\n# Compiled binary addons (http://nodejs.org/api/addons.html)\nbuild/Release\n# Dependency directories\nnode_modules\njspm_packages\n# Optional npm cache directory\n.npm\n# Optional REPL history\n.node_repl_history\n.idea\n.node_modules\nnode_modules\n.vscode\n")])])]),t("ol",{attrs:{start:"5"}},[t("li",[e._v("Dockerfile")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('#制定node镜像的版本\nFROM node:8.9-alpine\n#声明作者\nMAINTAINER evilboy\n#移动当前⽬录下⾯的⽂件到app⽬录下\nADD . /app/\n#进⼊到app⽬录下⾯，类似cd\nWORKDIR /app\n#安装依赖\nRUN npm install\n#对外暴露的端⼝\nEXPOSE 3000\n#程序启动脚本\nCMD ["npm", "start"]\n')])])]),t("ol",{attrs:{start:"6"}},[t("li",[e._v("构建镜像,然后使⽤docker images命令查看镜像")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker build -t docker_demo .\n")])])]),t("ol",{attrs:{start:"7"}},[t("li",[e._v("启动镜像 -d表示后台执⾏，-p 9000:3000表示指定本地的9000端⼝隐射到容器内的3000端⼝，\ndocker_demo为镜像名称")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -p 9000:3000 docker_demo\n")])])]),t("h2",{attrs:{id:"ssh-启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh-启动","aria-hidden":"true"}},[e._v("#")]),e._v(" ssh 启动")]),e._v(" "),t("ol",[t("li",[e._v("Dockerfile")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('FROM node\nLABEL name="vue-back"\nLABEL version="1.0"\nCOPY . /app\nWORKDIR /app\nRUN npm install\nEXPOSE 3000\nCMD npm start\n')])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("ssh node")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('#!/bin/bash\nWORK_PATH=\'/usr/projects/vue-front\'\ncd $WORK_PATH\necho "清除老代码"\ngit reset --hard origin/master\ngit clean -f\necho "拉取新代码"\ngit pull origin master\nnpm run build\necho "开始执行构建"\ndocker build -t vue-front:1.0 .\necho "停止旧容器并删除旧容器"\ndocker stop vue-front-container\ndocker rm vue-front-container\necho "启动新容器"\ndocker container run -p 8080:8080 --name vue-front-container -d vue-front:1.0\n')])])])])},[],!1,null,null,null);n.default=s.exports}}]);