(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{176:function(a,t,r){"use strict";r.r(t);var e=r(0),s=Object(e.a)({},function(){var a=this,t=a.$createElement,r=a._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[r("h2",{attrs:{id:"km2特性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#km2特性","aria-hidden":"true"}},[a._v("#")]),a._v(" km2特性")]),a._v(" "),r("blockquote",[r("ul",[r("li",[a._v("内建负载均衡（使用Node cluster 集群模块）")]),a._v(" "),r("li",[a._v("后台运行")]),a._v(" "),r("li",[a._v("0秒停机重载，我理解大概意思是维护升级的时候不需要停机.")]),a._v(" "),r("li",[a._v("具有Ubuntu和CentOS 的启动脚本")]),a._v(" "),r("li",[a._v("停止不稳定的进程（避免无限循环）")]),a._v(" "),r("li",[a._v("控制台检测")]),a._v(" "),r("li",[a._v("提供 HTTP API")]),a._v(" "),r("li",[a._v("远程控制和实时的接口API ( Nodejs 模块,允许和PM2进程管理器交互 )")])])]),a._v(" "),r("h2",{attrs:{id:"启动服务"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#启动服务","aria-hidden":"true"}},[a._v("#")]),a._v(" 启动服务")]),a._v(" "),r("p",[a._v("pm2 start app.js                //启动app.js应用\npm2 start app.js --name demo    //启动应用并设置name\npm2 start app.sh                //脚本启动")]),a._v(" "),r("h2",{attrs:{id:"停止服务"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#停止服务","aria-hidden":"true"}},[a._v("#")]),a._v(" 停止服务")]),a._v(" "),r("p",[a._v("pm2 stop all               //停止所有应用\npm2 stop [AppName]        //根据应用名停止指定应用\npm2 stop [ID]             //根据应用id停止指定应用")]),a._v(" "),r("h2",{attrs:{id:"删除应用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#删除应用","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除应用")]),a._v(" "),r("p",[a._v("pm2 delete all               //关闭并删除应用\npm2 delete [AppName]        //根据应用名关闭并删除应用\npm2 delete [ID]            //根据应用ID关闭并删除应用")]),a._v(" "),r("h2",{attrs:{id:"创建开机自启动"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#创建开机自启动","aria-hidden":"true"}},[a._v("#")]),a._v(" 创建开机自启动")]),a._v(" "),r("p",[a._v("pm2 startup")]),a._v(" "),r("h2",{attrs:{id:"更新pm2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#更新pm2","aria-hidden":"true"}},[a._v("#")]),a._v(" 更新PM2")]),a._v(" "),r("p",[a._v("pm2 updatePM2\npm2 update")]),a._v(" "),r("h2",{attrs:{id:"监听模式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#监听模式","aria-hidden":"true"}},[a._v("#")]),a._v(" 监听模式")]),a._v(" "),r("p",[a._v("pm2 start app.js --watch    //当文件发生变化，自动重启")]),a._v(" "),r("h2",{attrs:{id:"静态服务器"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#静态服务器","aria-hidden":"true"}},[a._v("#")]),a._v(" 静态服务器")]),a._v(" "),r("p",[a._v("pm2 serve ./dist 9090        //将目录dist作为静态服务器根目录，端口为9090")]),a._v(" "),r("h2",{attrs:{id:"启用群集模式（自动负载均衡）"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#启用群集模式（自动负载均衡）","aria-hidden":"true"}},[a._v("#")]),a._v(" 启用群集模式（自动负载均衡）")]),a._v(" "),r("p",[a._v("//max 表示PM2将自动检测可用CPU的数量并运行尽可能多的进程\n//max可以自定义，如果是4核CPU，设置为2者占用2个\npm2 start app.js -i max")]),a._v(" "),r("h2",{attrs:{id:"重新启动"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#重新启动","aria-hidden":"true"}},[a._v("#")]),a._v(" 重新启动")]),a._v(" "),r("p",[a._v("pm2 restart app.js        //同时杀死并重启所有进程。短时间内服务不可用。生成环境推荐使用reload")]),a._v(" "),r("h2",{attrs:{id:"_0秒停机重新加载"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_0秒停机重新加载","aria-hidden":"true"}},[a._v("#")]),a._v(" 0秒停机重新加载")]),a._v(" "),r("p",[a._v("pm2 reload app.js        //重新启动所有进程，始终保持至少一个进程在运行\npm2 gracefulReload all   //优雅地以群集模式重新加载所有应用程序")]),a._v(" "),r("h2",{attrs:{id:"查看启动列表"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查看启动列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 查看启动列表")]),a._v(" "),r("p",[a._v("pm2 list")]),a._v(" "),r("h2",{attrs:{id:"查看每个应用程序占用情况"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查看每个应用程序占用情况","aria-hidden":"true"}},[a._v("#")]),a._v(" 查看每个应用程序占用情况")]),a._v(" "),r("p",[a._v("pm2 monit")]),a._v(" "),r("h2",{attrs:{id:"显示应用程序所有信息"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#显示应用程序所有信息","aria-hidden":"true"}},[a._v("#")]),a._v(" 显示应用程序所有信息")]),a._v(" "),r("p",[a._v("pm2 show [Name]      //根据name查看\npm2 show [ID]        //根据id查看")]),a._v(" "),r("h2",{attrs:{id:"日志查看"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#日志查看","aria-hidden":"true"}},[a._v("#")]),a._v(" 日志查看")]),a._v(" "),r("p",[a._v("pm2 logs            //查看所有应用日志\npm2 logs [Name]    //根据指定应用名查看应用日志\npm2 logs [ID]      //根据指定应用ID查看应用日志")]),a._v(" "),r("h2",{attrs:{id:"保存当前应用列表"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#保存当前应用列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 保存当前应用列表")]),a._v(" "),r("p",[a._v("pm2 save")]),a._v(" "),r("h2",{attrs:{id:"重启保存的应用列表"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#重启保存的应用列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 重启保存的应用列表")]),a._v(" "),r("p",[a._v("pm2 resurrect")]),a._v(" "),r("h2",{attrs:{id:"清除保存的应用列表"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#清除保存的应用列表","aria-hidden":"true"}},[a._v("#")]),a._v(" 清除保存的应用列表")]),a._v(" "),r("p",[a._v("pm2 cleardump")]),a._v(" "),r("h2",{attrs:{id:"保存并恢复pm2进程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#保存并恢复pm2进程","aria-hidden":"true"}},[a._v("#")]),a._v(" 保存并恢复PM2进程")]),a._v(" "),r("p",[a._v("pm2 update")]),a._v(" "),r("h2",{attrs:{id:"pm2配置文件方式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pm2配置文件方式","aria-hidden":"true"}},[a._v("#")]),a._v(" PM2配置文件方式")]),a._v(" "),r("p",[a._v("生成示例配置文件\npm2 ecosystem        //生成一个示例JSON配置文件\npm2 init\n配置文件示例（实际使用自行删除）")]),a._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[a._v("module.exports = {\n    apps : [{\n        name      : 'API',      //应用名\n        script    : 'app.js',   //应用文件位置\n        env: {\n            PM2_SERVE_PATH: \".\",    //静态服务路径\n            PM2_SERVE_PORT: 8080,   //静态服务器访问端口\n            NODE_ENV: 'development' //启动默认模式\n        },\n        env_production : {\n            NODE_ENV: 'production'  //使用production模式 pm2 start ecosystem.config.js --env production\n        },\n        instances:\"max\",          //将应用程序分布在所有CPU核心上,可以是整数或负数\n        watch:true,               //监听模式\n        output: './out.log',      //指定日志标准输出文件及位置\n        error: './error.log',     //错误输出日志文件及位置，pm2 install pm2-logrotate进行日志文件拆分\n        merge_logs: true,         //集群情况下，可以合并日志\n        log_type:\"json\",          //日志类型\n        log_date_format: \"DD-MM-YYYY\",  //日志日期记录格式\n    }],\n    deploy : {\n        production : {\n            user : 'node',                      //ssh 用户\n            host : '212.83.163.1',              //ssh 地址\n            ref  : 'origin/master',             //GIT远程/分支\n            repo : 'git@github.com:repo.git',   //git地址\n            path : '/var/www/production',       //服务器文件路径\n            post-deploy : 'npm install && pm2 reload ecosystem.config.js --env production'  //部署后的动作\n        }\n    }\n};\n\n")])])])])},[],!1,null,null,null);t.default=s.exports}}]);